<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Odyssey — Greek / Lattimore / Wilson (lines)</title>
<style>
  body { font-family: Georgia, serif; padding: 20px; line-height: 1.4; }
  table { border-collapse: collapse; width: 100%; table-layout: fixed; }
  th, td { border: 1px solid #ddd; vertical-align: top; padding: 8px; width: 33%; }
  th { background: #f7f7f7; text-align: left; }
  .line-number { width: 40px; text-align: right; padding-right: 12px; color: #666; }
  .word { margin-right: 6px; padding: 2px 4px; border-radius: 4px; cursor: pointer; display: inline-block; }
  .word:hover { outline: 2px dotted #888; }

  /* POS color map — expand as needed */
  .pos-acc-noun { background: #ffe8e8; }
  .pos-noun { background: #fff2cc; }
  .pos-verb { background: #e6f7ff; }
  .pos-adj { background: #e8ffe8; }
  .pos-adv { background: #f0e6ff; }
  .pos-pron { background: #fff0f5; }
  .pos-participle { background: #fff6e6; }
  .pos-neg { background: #f8e6e6; }
  .pos-conj { background: #f2f2f2; }
  .pos-prop { background: #e8f7ff; }
  .pos-punct { background: transparent; }

  /* highlight styles */
  .highlight { box-shadow: 0 0 0 3px rgba(255, 200, 0, 0.35); transform: translateY(-1px); }
  .selected { box-shadow: 0 0 0 4px rgba(0, 150, 230, 0.25); transform: translateY(-1px); }

  /* small notes */
  .note { font-size: 0.9em; color: #444; margin-bottom: 12px; }

  @media (max-width: 900px) {
    table, thead, tbody, th, td, tr { display: block; }
    th { display: none; }
    td { width: 100%; }
    .line-number { display: block; margin-bottom: 6px; }
  }
</style>
</head>
<body>
<h2>Odyssey I — Greek aligned with Lattimore & Wilson (first lines)</h2>
<p class="note">Hover a word to highlight aligned words; click to lock selection. Colors indicate parts-of-speech (POS) by the <code>ana</code> label in the XML.</p>

<table>
  <thead>
    <tr><th class="line-number">#</th><th>Greek (original)</th><th>Lattimore (translation)</th><th>Wilson (translation)</th></tr>
  </thead>
  <tbody>

  </tbody>
</table>

<script>
// When hovering/clicking a word, highlight all words that are referenced in data-corresp or have matching id.
function normalizeIds(str){
  return (str||"").split(/\s+/).filter(Boolean);
}

function clearHighlights(){
  document.querySelectorAll('.highlight').forEach(e=>e.classList.remove('highlight'));
  // don't remove 'selected' (locked) here
}

let locked = null;

document.addEventListener('mouseover', function(e){
  if (locked) return;
  let el = e.target.closest('.word');
  clearHighlights();
  if (!el) return;
  // highlight self
  el.classList.add('highlight');
  // also highlight corresp targets
  const cor = el.getAttribute('data-corresp');
  if (cor){
    normalizeIds(cor).forEach(id=>{
      let t = document.getElementById(id);
      if (t) t.classList.add('highlight');
    });
  }
  // highlight words that refer to this id
  const myid = el.getAttribute('data-id');
  if (myid){
    document.querySelectorAll('[data-corresp]').forEach(function(other){
      const list = normalizeIds(other.getAttribute('data-corresp'));
      if (list.indexOf(myid) !== -1) other.classList.add('highlight');
    });
  }
});

document.addEventListener('mouseout', function(e){
  if (locked) return;
  // clear on mouseout unless moving into another word (handled by mouseover).
  // Slight delay to allow hover into another element
  setTimeout(function(){ if (!locked) clearHighlights(); }, 40);
});

document.addEventListener('click', function(e){
  let el = e.target.closest('.word');
  if (!el) {
    // click outside: clear lock
    if (locked){
      locked.classList.remove('selected');
      locked = null;
      clearHighlights();
    }
    return;
  }
  if (locked){
    locked.classList.remove('selected');
    locked = null;
    clearHighlights();
    return;
  }
  // lock this selection
  locked = el;
  el.classList.add('selected');
  // ensure its correspondences are highlighted
  clearHighlights();
  el.classList.add('highlight');
  const cor = el.getAttribute('data-corresp');
  if (cor){
    normalizeIds(cor).forEach(id=>{
      let t = document.getElementById(id);
      if (t) t.classList.add('highlight');
    });
  }
  const myid = el.getAttribute('data-id');
  if (myid){
    document.querySelectorAll('[data-corresp]').forEach(function(other){
      const list = normalizeIds(other.getAttribute('data-corresp'));
      if (list.indexOf(myid) !== -1) other.classList.add('highlight');
    });
  }
});

// keyboard: press Esc to clear locked selection
document.addEventListener('keydown', function(e){
  if (e.key === "Escape"){
    if (locked){
      locked.classList.remove('selected');
      locked = null;
      clearHighlights();
    }
  }
});
</script>

</body>
</html>
